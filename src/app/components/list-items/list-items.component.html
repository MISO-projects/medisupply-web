<div class="list-container">
  <div class="list-header">
    <h1 class="list-title">{{ config.title }}</h1>
    <div class="list-actions">
      <button 
        *ngIf="config.showUploadButton" 
        mat-icon-button
        matTooltip="{{ config.uploadButtonLabel || 'Subir' }}"
        (click)="onUploadClick()">
        <mat-icon>upload</mat-icon>
      </button>
      <button 
        *ngIf="config.showCreateButton" 
        matButton="filled"
        color="primary"
        (click)="onCreateClick()">
        <mat-icon>add</mat-icon>
        {{ config.createButtonLabel || 'Crear' }}
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Cargando...</p>
  </div>

  <div *ngIf="!loading && data.length === 0" class="empty-container">
    <mat-icon class="empty-icon">inbox</mat-icon>
    <p>{{ emptyMessage }}</p>
  </div>

  <div *ngIf="!loading && data.length > 0" class="table-container">
    <table mat-table [dataSource]="data" matSort (matSortChange)="onSortChange($event)" class="list-table">
      
      <ng-container *ngFor="let column of config.columns" [matColumnDef]="column.key">
        <th mat-header-cell *matHeaderCellDef mat-sort-header [disabled]="!column.sortable">
          {{ column.label }}
        </th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="column.type === 'status'" 
                class="status-chip"
                [class]="'status-' + getItemValue(element, column.key)">
            {{ getItemValue(element, column.key) }}
          </span>
          <span *ngIf="column.type === 'number'">
            {{ getItemValue(element, column.key) | number }}
          </span>
          <span *ngIf="column.type === 'date'">
            {{ getItemValue(element, column.key) | date:'short' }}
          </span>
          <span *ngIf="column.type !== 'status' && column.type !== 'number' && column.type !== 'date'">
            {{ getItemValue(element, column.key) }}
          </span>
        </td>
      </ng-container>

      <ng-container *ngIf="config.actions && config.actions.length > 0" matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="actions-cell"></th>
        <td mat-cell *matCellDef="let element" class="actions-cell">
          <button 
            mat-icon-button
            [matMenuTriggerFor]="actionMenu"
            matTooltip="MÃ¡s acciones">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #actionMenu="matMenu">
            <button 
              *ngFor="let action of config.actions"
              mat-menu-item
              [class]="action.color === 'danger' ? 'danger-action' : ''"
              (click)="onActionClick(action.action, element)">
              <mat-icon *ngIf="action.icon">{{ action.icon }}</mat-icon>
              <span>{{ action.label }}</span>
            </button>
          </mat-menu>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="getDisplayedColumns()"></tr>
      
      <tr mat-row *matRowDef="let row; columns: getDisplayedColumns();"></tr>
    </table>
  </div>
</div>

